Директива **~for** используется для создания последовательности однотипных HTML-элементов на основе заданного JSX-шаблона и указанного источника данных. В процессе работы директива последовательно извлекает элементы из источника данных, и на основе каждого такого элемента создает из шаблона очередной HTML-элемент.

В общем случае директива имеет следующий формат:

```info md_hideicon
**~for="item, index, items, key in dataSource"**
```

Параметр **dataSource** определяет источник данных для директивы. Источником данных могут быть массивы и объекты, а также любые JavaScript-выражения, значения которых фреймворк может преобразовать в массив или объект.

Параметры **item**, **index**, **items** и **key** являются переменными цикла и могут использоваться в шаблоне в JavaScript-выражениях. Эти параметры являются необязательными. Если какие-то переменные цикла не используются в шаблоне создаваемого HTML-элемента, то соответствующие параметры можно опустить при объявлении директивы.

Переменная цикла **item** содержит элемент данных, взятый из источника в текущем цикле.

Пример 1:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="item in array">Элемент: {{item}}</div>
    `,
    props: {
        array: [
            'A', 'B', 'C'
        ]
    }
});
```

В примере из массива **array** последовательно извлекаются все элементы, и для каждого из них создается свой собственный HTML-элемент **div**. Значение текущего элемента массива берется из переменной **item**.

Переменная цикла **index** содержит порядковый номер текущего элемента данных в источнике данных. Нумерация начинается с нуля. Если источник данных является массивом, то эта переменная фактически является индексом текущего элемента массива.

Пример 2:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="item, index in array">Элемент[{{index}}]: {{item}}</div>
    `,
    props: {
        array: [
            'A', 'B', 'C'
        ]
    }
});
```

Этот пример аналогичен предыдущему с учетом того, что помимо значения элемента массива также выводится его индекс, который берется из переменной цикла **index**.

Переменная цикла **items** является указателем на источник данных, из которого директива непосредственно извлекает данные. Если параметр **dataSource** является объектом или массивом, то **items** указывает на него. Если **dataSource** является JavaScript-выражением, то **items** указывает на внутренний источник данных, который сформировал фреймворк из результата выполнения этого выражения.

Пример 3:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="item, index, items in array">Элемент[{{index}}]: {{item}} - array: {{items}}</div>
    `,
    props: {
        array: [
            'A', 'B', 'C'
        ]
    }
});
```

Этот пример аналогичен предыдущему с учетом того, что в каждом элементе **div** дополнительно выводится содержимое исходного массива, на который ссылается указатель **items**.

Переменная цикла **key** содержит имя текущего свойства объекта, если источник данных является объектом. Если источник данных является массивом, то эта переменная содержит порядковый номер элемента данных аналогично переменной **index**.

Пример 4:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <style>
            span {padding-left: 25px}
        </style>
        <div>object {</div>
        <span ~for="item, , , key in object">{{key}}: {{item}},</span>
        <div>}</div>
    `,
    props: {
        object: {
            prop1:'A', prop2:'B', prop3:'C'
        }
    }
});
```

В примере из объекта **object** последовательно извлекаются все свойства, и для каждого из них создается свой собственный HTML-элемент **div**. Переменная **key** используется для вывода имени свойства. Переменная **item** используется для вывода значения свойства.

```faq_md
Обратите внимание, что переменные цикла **index** и **items** не используются в шаблоне, поэтому их имена опущены при объявлении директивы. Однако в директиве сохранены все запятые, которые должны отделять переменные цикла друг от друга, чтобы указать позицию последней переменной **key**.
```

```info_md
Кроме структуры цикла **for...in**, можно использовать структуру **for...of**.
```

Пример 5:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <style>
            span {padding-left: 25px}
        </style>
        <div>object {</div>
        <span ~for="item, , , key of object">{{key}}: {{item}},</span>
        <div>}</div>
    `,
    props: {
        object: {
            prop1:'A', prop2:'B', prop3:'C'
        }
    }
});
```

Результат выполнения этого примера будет точно таким же, как и у предыдущего.

```info_md
Если при объявлении директивы **~for** опущены какие-то параметры, то фреймворк автоматически создаст для них переменные с именами **item**, **index**, **items**, **key** соответственно.
```

Пример 6:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="object">{{index+1}}-е свойство {{key}}: {{item}} -- object: {{JSON.stringify(items)}}</div>
    `,
    props: {
        object: {
            prop1:'A', prop2:'B', prop3:'C'
        }
    }
});
```

В примере при объявлении директивы **~for** указан только источник данных, а переменные цикла **item**, **index**, **items** и **key** созданы фреймворком автоматически.

```warning_md
Если компонент имеет свойства с такими же именами как у переменных цикла в директиве **~for**, то в качестве значений переменных цикла будут использоваться значения свойств компонента.
```

Пример 7:

```javascript _error_run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="item, index, items, key in object">{{index}}-е свойство {{key}}: {{item}} -- object: {{JSON.stringify(items)}}</div>
    `,
    props: {
        object: {
            prop1:'A', prop2:'B', prop3:'C'
        },
        item: 'ошибка',
        index: 'N',
        items: 'неправильная ссылка',
        key: 'error'
    }
});
```

В примере значения переменных цикла **item**, **index**, **items** и **key** будут одинаковыми во всех созданных **div** элементах, т.к. они перекрываются значениями свойств самого компонента с теми же самыми именами.

```info_md
Область действия переменных цикла ограничена HTML-элементом, в котором объявлена директива **~for**. На уровне компонента переменные цикла недоступны.
```

Пример 8:

```javascript _error_run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="item, index, items, key in object">{{key}}: {{this.item}}</div>
    `,
    props: {
        object: {
            prop1:'A', prop2:'B', prop3:'C'
        }
    }
});
```

В примере мы пытаемся обратиться к переменной цикла **item**, используя указатель на компонент **this**. Но поскольку эта переменная не является свойством компонента, на страницу выводится значение **undefind**.

Если необходимо использовать переменную цикла за пределами HTML-элемента, в котором она объявлена, то ее необходимо передать методу в качестве параметра.

Пример 9:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="item, index, items, key in object">{{key}}: {{getItem(items,key)}}</div>
    `,
    props: {
        object: {
            prop1:'A', prop2:'B', prop3:'C'
        }
    },
    getItem(obj, prop) {
        return obj[prop];
    }
});
```

В примере текущее значение для директивы **~for** формируется методом **getItem**. В качестве параметров этому методу передаются источник данных из переменной **items** и имя текущего свойства из переменной **key**.

Директива **~for** обрабатывает все элементы из источника данных, даже если эти элементы неопределенны.

Пример 10:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="array">Элемент[{{index}}]: {{item}}</div>
    `,
    props: {
        array: [
            'A', , 'C'
        ]
    }
});
```

В примере в объявлении массива **array** пропущен элемент с индексом **1**. Однако фреймворк все равно создает для него HTML-элемент **div**, используя значение **undefind**.

Чтобы исключить создание HTML-элементов для отсутствующих элементов исходных данных, директиву **~for** необходимо использовать совместно с директивой **~if**, параметром которой служит текущий элемент данных.

Пример 11:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="array" ~if="item">Элемент[{{index}}]: {{item}}</div>
    `,
    props: {
        array: [
            'A', , 'C'
        ]
    }
});
```

Этот пример аналогичен предыдущему, за исключением того, что неопределенный элемент с индексом **1** из массива **array** теперь отфильтровывается директивой **~if="item"**.

С помощью директивы **~for** можно вывести последовательность целых чисел, начиная с 1, если значение, указанное в источнике данных, можно привести к целому типу. Последнее число в генерируемой последовательности определяется значением источника данных.

Пример 12:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="Math.floor(sourceData)">Элемент[{{index}}]: {{item}} – источник данных: [{{items}}]</div>
    `,
    props: {
        sourceData: 7.1
    }
});
```

В примере источником данных для директивы **~for** является JS-выражение, преобразующее вещественное число к целому типу. В данном примере это выражении равно 7, поэтому директива создает семь элементов **div**. Переменная цикла **items** используется для демонстрации содержимого источника данных, созданного фреймворком для директивы. В данном примере это массив с последовательностью целых чисел от 1 до 7.

Если источником данных является символьная строка, то директива **~for** обрабатывает ее как массив отдельных символов.

Пример 13:

```javascript _run_edit_[my-component.js]
ODA({
    is: 'my-component',
    template: `
        <div ~for="sourceData">Элемент[{{index}}]: {{item}} – источник данных: [{{items}}]</div>
    `,
    props: {
        sourceData: "Привет!"
    }
});
```

В данном примере в качестве источника данных используется символьная строка **"Привет!"**. Директива раскладывает ее на отдельные символы. Переменная цикла **items** используется для демонстрации содержимого реального источника данных, с которым оперирует директива.

<div style="position:relative;padding-bottom:48%; margin:10px">
    <iframe src="https://www.youtube.com/embed/5grvyQc4-bI?start=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen
    	style="position:absolute;width:100%;height:100%;"></iframe>
</div>

